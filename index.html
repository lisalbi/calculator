<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Calculator</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://use.typekit.net/tfw3wfo.css">
</head>
<body>
    <header>
        <h1>JS Calculator</h1>
    </header>
    <div id="calculatorContainer">
        <div id="screen">0</div>
        <div id="btnContainer">
            <button class="btn" id="clear">AC</button>
            <button class="btn" id="backspace">←</button>
            <button class="btn" id="sign">+/-</button>
            <button class="btn operator" id="divide">÷</button>
            <button class="btn number" id="seven">7</button>
            <button class="btn number" id="eight">8</button>
            <button class="btn number" id="nine">9</button>
            <button class="btn operator" id="multiply">x</button>
            <button class="btn number" id="four">4</button>
            <button class="btn number" id="five">5</button>
            <button class="btn number" id="six">6</button>
            <button class="btn operator" id="subtraction">-</button>
            <button class="btn number" id="one">1</button>
            <button class="btn number" id="two">2</button>
            <button class="btn number" id="three">3</button>
            <button class="btn operator" id="add">+</button>
            <button class="btn number" id="zero">0</button>
            <button class="btn number" id="decimal">.</button>
            <button class="btn" id="equals">=</button>

        </div>

    </div>
</body>
<script>
    let operandA = '';
    let operandB = '';
    let operator = '';
    let operatorBtn = '';
    let startNewNumber = false;
    const screen = document.querySelector('#screen');
    const clearBtn = document.querySelector('#clear');
    const backspaceBtn = document.querySelector('#backspace');
    const numberBtns = document.querySelectorAll(".number");
    numberBtns.forEach((btn) =>
        btn.addEventListener('click', function() {
            if (operatorBtn) {
                operatorBtn.classList.remove('active');
            }
            updateScreen(btn.textContent);
        })
    );
    clearBtn.addEventListener('click', function() {
        if (operatorBtn) {
                operatorBtn.classList.remove('active');
            }
        if (screen.textContent === '0') {
            allClear();
        }
        else {
            clear();
        }
    });
    const operatorBtns = document.querySelectorAll(".operator");
    operatorBtns.forEach((btn) => 
        btn.addEventListener('click', function() {
            if (operatorBtn) {
                operatorBtn.classList.remove('active');
            }
            updateOperands();
            operatorPressed(btn.textContent);
            operatorBtn = this;
            this.classList.add('active');
        })
    );
    backspaceBtn.addEventListener('click', function() {
        if (operatorBtn) {
                operatorBtn.classList.remove('active');
            }
        screen.textContent = screen.textContent.slice(0, -1);
    });
    const equalsBtn = document.querySelector('#equals');
    equalsBtn.addEventListener('click', function() {
        if (operatorBtn) {
                operatorBtn.classList.remove('active');
            }
        updateOperands();
        result = operate(operator, operandA, operandB);
        operandA = '';
        operandB = result;
        operator = '';
        screen.textContent = result;
        startNewNumber = true;
        console.log('startNewNumber = true');
    })


    function add(a, b) {
        return a + b;
    }
    function subtract(a, b) {
        return a - b;
    }
    function multiply(a, b) {
        return a*b;
    }
    function divide(a, b) {
        return a/b;
    }
    function operate(operator, x, y) {
        switch(operator) {
            case '+':
                result = add(x, y);
                break;
            case '-':
                result = subtract(x, y);
                break;
            case 'x':
                result = multiply(x, y);
                break;
            case '÷':
                result = divide(x, y);
                break;
        }
        return result;
    }

    function operatorPressed(newOperator) {
        startNewNumber = true;
        console.log('startNewNumber = true');
        if (operandA && operandB && operator) {
            operandB = operate(operator, operandA, operandB);
            updateScreen(operandB);
            operator = newOperator;
            console.log('operator pressed 1');
        }
        else if (operandA && operandB && !operator) {
            operandAP = '';
            operator = newOperator;
        }
        else if (!operandA && operandB) {
            operator = newOperator;
            console.log('operator pressed 2');
        }
    }

    function updateScreen(x) {
        if (screen.textContent === "0" || startNewNumber === true) {
            screen.textContent = x;
            clearBtn.textContent = 'C';
            startNewNumber = false;

        }
        else {
            console.log('append');
            screen.textContent += x;
        }
    }

    function updateOperands() {
        if (!operandB) {
            operandB = parseFloat(screen.textContent);
        }
        else {
            operandA = operandB;
            operandB = parseFloat(screen.textContent);
        }
    }

    function clear() {
        screen.textContent = '0';
        clearBtn.textContent = 'AC'
        startNewNumber = false;
    }

    function allClear() {
        screen.textContent = '0';
        operandA = '';
        operandB = '';
    }
</script>

<!-- Notes
-AC changes to C, make an operator pressed class -->